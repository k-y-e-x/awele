                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ANSI-C Compiler
                                      3 ; Version 4.0.7 #12016 (Mac OS X x86_64)
                                      4 ;--------------------------------------------------------
                                      5 	.module awele
                                      6 	.optsdcc -mgbz80
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _main
                                     12 	.globl _initPartie
                                     13 	.globl _choixJoueur
                                     14 	.globl _initPlateau
                                     15 	.globl _afficherPlateau
                                     16 	.globl _initJoystick
                                     17 	.globl _effacerAttente
                                     18 	.globl _afficherAttente
                                     19 	.globl _afficherPosEval
                                     20 	.globl _afficherResultats
                                     21 	.globl _menuOptions
                                     22 	.globl _alphabeta
                                     23 	.globl _jouer
                                     24 	.globl _jeuPoss
                                     25 	.globl _temp
                                     26 	.globl _j
                                     27 	.globl _tab
                                     28 	.globl _prof
                                     29 	.globl _jeu
                                     30 ;--------------------------------------------------------
                                     31 ; special function registers
                                     32 ;--------------------------------------------------------
                                     33 ;--------------------------------------------------------
                                     34 ; ram data
                                     35 ;--------------------------------------------------------
                                     36 	.area _DATA
      000000                         37 _jeu::
      000000                         38 	.ds 18
      000012                         39 _prof::
      000012                         40 	.ds 2
      000014                         41 _tab::
      000014                         42 	.ds 20
      000028                         43 _j::
      000028                         44 	.ds 2
      00002A                         45 _temp::
      00002A                         46 	.ds 64
                                     47 ;--------------------------------------------------------
                                     48 ; absolute external ram data
                                     49 ;--------------------------------------------------------
                                     50 	.area _DABS (ABS)
                                     51 ;--------------------------------------------------------
                                     52 ; global & static initialisations
                                     53 ;--------------------------------------------------------
                                     54 	.area _HOME
                                     55 	.area _GSINIT
                                     56 	.area _GSFINAL
                                     57 	.area _GSINIT
                                     58 ;--------------------------------------------------------
                                     59 ; Home
                                     60 ;--------------------------------------------------------
                                     61 	.area _HOME
                                     62 	.area _HOME
                                     63 ;--------------------------------------------------------
                                     64 ; code
                                     65 ;--------------------------------------------------------
                                     66 	.area _CODE
                                     67 ;src/awele.c:11: void initPartie(void)
                                     68 ;	---------------------------------
                                     69 ; Function initPartie
                                     70 ; ---------------------------------
      000000                         71 _initPartie::
                                     72 ;src/awele.c:15: posEval = 0;
      000000 21r00r00                73 	ld	hl, #_posEval
      000003 3E 00                   74 	ld	a, #0x00
      000005 22                      75 	ld	(hl+), a
      000006 36 00                   76 	ld	(hl), #0x00
                                     77 ;src/awele.c:16: for(i=0;i<NCASES;i++)
      000008 0E 00                   78 	ld	c, #0x00
      00000A                         79 00102$:
                                     80 ;src/awele.c:17: jeu[NCASES+1+i] = jeu[i] = NGRAINS;
      00000A 79                      81 	ld	a, c
      00000B C6 09                   82 	add	a, #0x09
      00000D 5F                      83 	ld	e, a
      00000E 17                      84 	rla
      00000F 9F                      85 	sbc	a, a
      000010 57                      86 	ld	d, a
      000011 21r00r00                87 	ld	hl, #_jeu
      000014 19                      88 	add	hl, de
      000015 5D                      89 	ld	e, l
      000016 54                      90 	ld	d, h
      000017 21r00r00                91 	ld	hl, #_jeu
      00001A 06 00                   92 	ld	b, #0x00
      00001C 09                      93 	add	hl, bc
      00001D 3E 04                   94 	ld	a,#0x04
      00001F 77                      95 	ld	(hl),a
      000020 12                      96 	ld	(de), a
                                     97 ;src/awele.c:16: for(i=0;i<NCASES;i++)
      000021 0C                      98 	inc	c
      000022 79                      99 	ld	a, c
      000023 D6 08                  100 	sub	a, #0x08
      000025 38 E3                  101 	jr	C, 00102$
                                    102 ;src/awele.c:18: jeu[KALAH2] = jeu[KALAH1] = 0;
      000027 21r08r00               103 	ld	hl, #(_jeu + 0x0008)
      00002A 36 00                  104 	ld	(hl), #0x00
      00002C 21r11r00               105 	ld	hl, #(_jeu + 0x0011)
      00002F 36 00                  106 	ld	(hl), #0x00
                                    107 ;src/awele.c:19: prof[0]=prof[1]=1;
      000031 21r13r00               108 	ld	hl, #(_prof + 0x0001)
      000034 36 01                  109 	ld	(hl), #0x01
      000036 21r12r00               110 	ld	hl, #_prof
      000039 36 01                  111 	ld	(hl), #0x01
                                    112 ;src/awele.c:20: j[0]=0;j[1]=1;
      00003B 01r28r00               113 	ld	bc, #_j+0
      00003E AF                     114 	xor	a, a
      00003F 02                     115 	ld	(bc), a
      000040 03                     116 	inc	bc
      000041 3E 01                  117 	ld	a, #0x01
      000043 02                     118 	ld	(bc), a
                                    119 ;src/awele.c:27: }
      000044 C9                     120 	ret
                                    121 ;src/awele.c:29: void main (void)
                                    122 ;	---------------------------------
                                    123 ; Function main
                                    124 ; ---------------------------------
      000045                        125 _main::
      000045 E8 F6                  126 	add	sp, #-10
                                    127 ;src/awele.c:33: BOOLEAN b=TRUE, rejoue = TRUE;
      000047 F8 02                  128 	ldhl	sp,	#2
      000049 36 01                  129 	ld	(hl), #0x01
      00004B AF                     130 	xor	a, a
      00004C 23                     131 	inc	hl
      00004D 77                     132 	ld	(hl), a
                                    133 ;src/awele.c:35: initJoystick(); 
      00004E CDr00r00               134 	call	_initJoystick
                                    135 ;src/awele.c:36: initPlateau();
      000051 CDr00r00               136 	call	_initPlateau
                                    137 ;src/awele.c:38: do
      000054                        138 00120$:
                                    139 ;src/awele.c:40: initPartie();
      000054 CDr00r00               140 	call	_initPartie
                                    141 ;src/awele.c:41: afficherPlateau(jeu);
      000057 21r00r00               142 	ld	hl, #_jeu
      00005A E5                     143 	push	hl
      00005B CDr00r00               144 	call	_afficherPlateau
      00005E E8 02                  145 	add	sp, #2
                                    146 ;src/awele.c:42: i=menuOptions(0); 
      000060 AF                     147 	xor	a, a
      000061 F5                     148 	push	af
      000062 33                     149 	inc	sp
      000063 CDr00r00               150 	call	_menuOptions
      000066 33                     151 	inc	sp
      000067 F8 04                  152 	ldhl	sp,	#4
      000069 73                     153 	ld	(hl), e
                                    154 ;src/awele.c:43: afficherPlateau(jeu);
      00006A 21r00r00               155 	ld	hl, #_jeu
      00006D E5                     156 	push	hl
      00006E CDr00r00               157 	call	_afficherPlateau
      000071 E8 02                  158 	add	sp, #2
                                    159 ;src/awele.c:46: do
      000073                        160 00117$:
                                    161 ;src/awele.c:48: if( j[i] )
                                    162 ;c
      000073 11r28r00               163 	ld	de, #_j
      000076 F8 04                  164 	ldhl	sp,	#4
      000078 6E                     165 	ld	l, (hl)
      000079 26 00                  166 	ld	h, #0x00
      00007B 19                     167 	add	hl, de
      00007C 33                     168 	inc	sp
      00007D 33                     169 	inc	sp
      00007E 5D                     170 	ld	e, l
      00007F 54                     171 	ld	d, h
      000080 D5                     172 	push	de
      000081 1A                     173 	ld	a, (de)
      000082 4F                     174 	ld	c, a
                                    175 ;src/awele.c:58: afficherAttente(i+1,tab[c]);
      000083 F8 04                  176 	ldhl	sp,	#4
      000085 2A                     177 	ld	a, (hl+)
      000086 77                     178 	ld	(hl), a
                                    179 ;src/awele.c:65: i=1-i;	// pour sortir et ne pas changer i
      000087 3E 01                  180 	ld	a, #0x01
      000089 96                     181 	sub	a, (hl)
      00008A 23                     182 	inc	hl
      00008B 77                     183 	ld	(hl), a
                                    184 ;src/awele.c:48: if( j[i] )
      00008C 79                     185 	ld	a, c
      00008D B7                     186 	or	a, a
      00008E CAr3Dr01               187 	jp	Z, 00135$
                                    188 ;src/awele.c:51: posEval=0;
      000091 21r00r00               189 	ld	hl, #_posEval
      000094 3E 00                  190 	ld	a, #0x00
      000096 22                     191 	ld	(hl+), a
      000097 36 00                  192 	ld	(hl), #0x00
                                    193 ;src/awele.c:52: afficherPosEval();
      000099 CDr00r00               194 	call	_afficherPosEval
                                    195 ;src/awele.c:53: alphabeta(jeu, MOINS_INFINI, PLUS_INFINI, i, prof[i], 0, tab);
      00009C 01r14r00               196 	ld	bc, #_tab
                                    197 ;c
      00009F 11r12r00               198 	ld	de, #_prof
      0000A2 F8 04                  199 	ldhl	sp,	#4
      0000A4 6E                     200 	ld	l, (hl)
      0000A5 26 00                  201 	ld	h, #0x00
      0000A7 19                     202 	add	hl, de
      0000A8 5D                     203 	ld	e, l
      0000A9 54                     204 	ld	d, h
      0000AA 1A                     205 	ld	a, (de)
      0000AB C5                     206 	push	bc
      0000AC 26 00                  207 	ld	h, #0x00
      0000AE E5                     208 	push	hl
      0000AF 33                     209 	inc	sp
      0000B0 F5                     210 	push	af
      0000B1 33                     211 	inc	sp
      0000B2 F8 08                  212 	ldhl	sp,	#8
      0000B4 7E                     213 	ld	a, (hl)
      0000B5 F5                     214 	push	af
      0000B6 33                     215 	inc	sp
      0000B7 21 E8 03               216 	ld	hl, #0x03e8
      0000BA E5                     217 	push	hl
      0000BB 21 18 FC               218 	ld	hl, #0xfc18
      0000BE E5                     219 	push	hl
      0000BF 21r00r00               220 	ld	hl, #_jeu
      0000C2 E5                     221 	push	hl
      0000C3 CDr00r00               222 	call	_alphabeta
      0000C6 E8 0B                  223 	add	sp, #11
                                    224 ;src/awele.c:54: afficherPosEval();
      0000C8 CDr00r00               225 	call	_afficherPosEval
                                    226 ;src/awele.c:55: for(c=0,b=1;b;c++)
      0000CB F8 02                  227 	ldhl	sp,	#2
      0000CD 36 01                  228 	ld	(hl), #0x01
      0000CF AF                     229 	xor	a, a
      0000D0 23                     230 	inc	hl
      0000D1 77                     231 	ld	(hl), a
      0000D2 F8 00                  232 	ldhl	sp,	#0
      0000D4 2A                     233 	ld	a, (hl+)
      0000D5 5E                     234 	ld	e, (hl)
      0000D6 F8 07                  235 	ldhl	sp,	#7
      0000D8 22                     236 	ld	(hl+), a
      0000D9 73                     237 	ld	(hl), e
      0000DA AF                     238 	xor	a, a
      0000DB 23                     239 	inc	hl
      0000DC 77                     240 	ld	(hl), a
      0000DD                        241 00124$:
      0000DD F8 03                  242 	ldhl	sp,	#3
      0000DF 3A                     243 	ld	a, (hl-)
      0000E0 B6                     244 	or	a, (hl)
      0000E1 CAr86r01               245 	jp	Z, 00115$
                                    246 ;src/awele.c:57: b = jouer(jeu, jeu, tab[c], i);
                                    247 ;c
      0000E4 11r14r00               248 	ld	de, #_tab
      0000E7 F8 09                  249 	ldhl	sp,	#9
      0000E9 6E                     250 	ld	l, (hl)
      0000EA 26 00                  251 	ld	h, #0x00
      0000EC 19                     252 	add	hl, de
      0000ED 4D                     253 	ld	c, l
      0000EE 44                     254 	ld	b, h
      0000EF 0A                     255 	ld	a, (bc)
      0000F0 C5                     256 	push	bc
      0000F1 F8 06                  257 	ldhl	sp,	#6
      0000F3 66                     258 	ld	h, (hl)
      0000F4 E5                     259 	push	hl
      0000F5 33                     260 	inc	sp
      0000F6 F5                     261 	push	af
      0000F7 33                     262 	inc	sp
      0000F8 21r00r00               263 	ld	hl, #_jeu
      0000FB E5                     264 	push	hl
      0000FC E5                     265 	push	hl
      0000FD CDr00r00               266 	call	_jouer
      000100 E8 06                  267 	add	sp, #6
      000102 C1                     268 	pop	bc
      000103 F8 02                  269 	ldhl	sp,	#2
      000105 7B                     270 	ld	a, e
      000106 22                     271 	ld	(hl+), a
      000107 72                     272 	ld	(hl), d
                                    273 ;src/awele.c:58: afficherAttente(i+1,tab[c]);
      000108 0A                     274 	ld	a, (bc)
      000109 23                     275 	inc	hl
      00010A 23                     276 	inc	hl
      00010B 46                     277 	ld	b, (hl)
      00010C 04                     278 	inc	b
      00010D F5                     279 	push	af
      00010E 33                     280 	inc	sp
      00010F C5                     281 	push	bc
      000110 33                     282 	inc	sp
      000111 CDr00r00               283 	call	_afficherAttente
      000114 E8 02                  284 	add	sp, #2
                                    285 ;src/awele.c:59: effacerAttente();
      000116 CDr00r00               286 	call	_effacerAttente
                                    287 ;src/awele.c:60: afficherPlateau(jeu);
      000119 21r00r00               288 	ld	hl, #_jeu
      00011C E5                     289 	push	hl
      00011D CDr00r00               290 	call	_afficherPlateau
      000120 E8 02                  291 	add	sp, #2
                                    292 ;src/awele.c:61: if(j[i]==0)	// on a changé d'ordi vers joueur
      000122 F8 07                  293 	ldhl	sp,#7
      000124 2A                     294 	ld	a, (hl+)
      000125 5F                     295 	ld	e, a
      000126 56                     296 	ld	d, (hl)
      000127 1A                     297 	ld	a, (de)
      000128 B7                     298 	or	a, a
      000129 20 0D                  299 	jr	NZ, 00125$
                                    300 ;src/awele.c:63: if(b)	// si le joueur en cours peut encore jouer on garde la main
      00012B F8 03                  301 	ldhl	sp,	#3
      00012D 3A                     302 	ld	a, (hl-)
      00012E B6                     303 	or	a, (hl)
      00012F 28 55                  304 	jr	Z, 00115$
                                    305 ;src/awele.c:65: i=1-i;	// pour sortir et ne pas changer i
      000131 F8 06                  306 	ldhl	sp,	#6
      000133 3A                     307 	ld	a, (hl-)
      000134 2B                     308 	dec	hl
      000135 77                     309 	ld	(hl), a
                                    310 ;src/awele.c:67: break;
      000136 18 4E                  311 	jr	00115$
      000138                        312 00125$:
                                    313 ;src/awele.c:55: for(c=0,b=1;b;c++)
      000138 F8 09                  314 	ldhl	sp,	#9
      00013A 34                     315 	inc	(hl)
      00013B 18 A0                  316 	jr	00124$
                                    317 ;src/awele.c:74: do
      00013D                        318 00135$:
      00013D F8 00                  319 	ldhl	sp,	#0
      00013F 2A                     320 	ld	a, (hl+)
      000140 5E                     321 	ld	e, (hl)
      000141 F8 08                  322 	ldhl	sp,	#8
      000143 22                     323 	ld	(hl+), a
      000144 73                     324 	ld	(hl), e
      000145                        325 00110$:
                                    326 ;src/awele.c:76: c = choixJoueur(i);
      000145 F8 04                  327 	ldhl	sp,	#4
      000147 7E                     328 	ld	a, (hl)
      000148 F5                     329 	push	af
      000149 33                     330 	inc	sp
      00014A CDr00r00               331 	call	_choixJoueur
      00014D 33                     332 	inc	sp
      00014E 4B                     333 	ld	c, e
                                    334 ;src/awele.c:77: if(j[i]==1)	// on a changé de joueur vers ordi
      00014F F8 08                  335 	ldhl	sp,#8
      000151 2A                     336 	ld	a, (hl+)
      000152 5F                     337 	ld	e, a
      000153 56                     338 	ld	d, (hl)
      000154 1A                     339 	ld	a, (de)
      000155 3D                     340 	dec	a
      000156 20 07                  341 	jr	NZ, 00107$
                                    342 ;src/awele.c:79: i=1-i;	// pour sortir et ne pas changer i
      000158 F8 06                  343 	ldhl	sp,	#6
      00015A 3A                     344 	ld	a, (hl-)
      00015B 2B                     345 	dec	hl
      00015C 77                     346 	ld	(hl), a
                                    347 ;src/awele.c:81: break;
      00015D 18 27                  348 	jr	00115$
      00015F                        349 00107$:
                                    350 ;src/awele.c:83: if(c==99)	continue;
      00015F 79                     351 	ld	a, c
      000160 D6 63                  352 	sub	a, #0x63
      000162 28 1C                  353 	jr	Z, 00111$
                                    354 ;src/awele.c:84: b = jouer(jeu, jeu, c, i);
      000164 F8 04                  355 	ldhl	sp,	#4
      000166 46                     356 	ld	b, (hl)
      000167 C5                     357 	push	bc
      000168 21r00r00               358 	ld	hl, #_jeu
      00016B E5                     359 	push	hl
      00016C E5                     360 	push	hl
      00016D CDr00r00               361 	call	_jouer
      000170 E8 06                  362 	add	sp, #6
      000172 F8 02                  363 	ldhl	sp,	#2
      000174 7B                     364 	ld	a, e
      000175 22                     365 	ld	(hl+), a
      000176 72                     366 	ld	(hl), d
                                    367 ;src/awele.c:85: afficherPlateau(jeu);
      000177 21r00r00               368 	ld	hl, #_jeu
      00017A E5                     369 	push	hl
      00017B CDr00r00               370 	call	_afficherPlateau
      00017E E8 02                  371 	add	sp, #2
      000180                        372 00111$:
                                    373 ;src/awele.c:86: } while(b);
      000180 F8 03                  374 	ldhl	sp,	#3
      000182 3A                     375 	ld	a, (hl-)
      000183 B6                     376 	or	a, (hl)
      000184 20 BF                  377 	jr	NZ, 00110$
      000186                        378 00115$:
                                    379 ;src/awele.c:89: i=1-i;
      000186 F8 04                  380 	ldhl	sp,	#4
      000188 4E                     381 	ld	c, (hl)
      000189 3E 01                  382 	ld	a, #0x01
      00018B 91                     383 	sub	a, c
      00018C 77                     384 	ld	(hl), a
                                    385 ;src/awele.c:90: } while((jeu[(2-i)*NCASES+1-i] <= NCASES*NGRAINS) &&  jeuPoss(jeu, i));
      00018D 4E                     386 	ld	c, (hl)
      00018E 3E 02                  387 	ld	a, #0x02
      000190 91                     388 	sub	a, c
      000191 87                     389 	add	a, a
      000192 87                     390 	add	a, a
      000193 87                     391 	add	a, a
      000194 3C                     392 	inc	a
      000195 91                     393 	sub	a, c
      000196 4F                     394 	ld	c, a
      000197 17                     395 	rla
      000198 9F                     396 	sbc	a, a
      000199 47                     397 	ld	b, a
      00019A 21r00r00               398 	ld	hl, #_jeu
      00019D 09                     399 	add	hl, bc
      00019E 4E                     400 	ld	c, (hl)
      00019F 3E 20                  401 	ld	a, #0x20
      0001A1 91                     402 	sub	a, c
      0001A2 38 14                  403 	jr	C, 00119$
      0001A4 F8 04                  404 	ldhl	sp,	#4
      0001A6 7E                     405 	ld	a, (hl)
      0001A7 F5                     406 	push	af
      0001A8 33                     407 	inc	sp
      0001A9 21r00r00               408 	ld	hl, #_jeu
      0001AC E5                     409 	push	hl
      0001AD CDr00r00               410 	call	_jeuPoss
      0001B0 E8 03                  411 	add	sp, #3
      0001B2 4B                     412 	ld	c, e
      0001B3 7A                     413 	ld	a, d
      0001B4 B1                     414 	or	a, c
      0001B5 C2r73r00               415 	jp	NZ, 00117$
      0001B8                        416 00119$:
                                    417 ;src/awele.c:91: rejoue = afficherResultats(jeu[KALAH1],jeu[KALAH2]);
      0001B8 21r11r00               418 	ld	hl, #(_jeu + 0x0011)
      0001BB 46                     419 	ld	b, (hl)
      0001BC FAr08r00               420 	ld	a, (#(_jeu + 0x0008) + 0)
      0001BF C5                     421 	push	bc
      0001C0 33                     422 	inc	sp
      0001C1 F5                     423 	push	af
      0001C2 33                     424 	inc	sp
      0001C3 CDr00r00               425 	call	_afficherResultats
      0001C6 E8 02                  426 	add	sp, #2
                                    427 ;src/awele.c:92: } while(rejoue);
      0001C8 7A                     428 	ld	a, d
      0001C9 B3                     429 	or	a, e
      0001CA C2r54r00               430 	jp	NZ, 00120$
                                    431 ;src/awele.c:93: }
      0001CD E8 0A                  432 	add	sp, #10
      0001CF C9                     433 	ret
                                    434 	.area _CODE
                                    435 	.area _CABS (ABS)
